<!DOCTYPE html>
<html>
  <head>
    <link rel="shortcut icon" type="image/x-icon" href="../../../favicon.ico" />
<link href="../../../css/bootstrap/bootstrap.css" rel="stylesheet" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="../../../css/bootstrap/bootstrap-responsive.css" rel="stylesheet" />
<link rel="stylesheet" type="text/css" href="../../../css/swc.css" />
<link rel="stylesheet" type="text/css" href="../../../css/swc-bootstrap.css" />
<link rel="alternate" type="application/rss+xml" title="The Software Carpentry Blog" href="/feed.xml"/>
<meta http-equiv="last-modified" content="2013-12-10T02:10:10Z" />
<!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

    <title>Software Carpentry: Handling Variant Configuration Files</title>
  </head>
  <body>
    <header class="header">
      <div class="navbar transparent navbar-inverse">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a href='../../../index.html' id="nav-logo" class="pull-left"></a>
      <div class="nav-collapse collapse pull-right">
        <ul class="nav">

          <li id="nav-bootcamps">
            <a href="../../../bootcamps/index.html">Bootcamps</a>
          </li>
          <li id="nav-volunteer">
            <a href="../../../contrib/training.html">Volunteer</a>
          </li>
          <li id="nav-about">
            <a href="../../../team.html">About</a>
          </li>
          <li id="nav-blog">
            <a href="../../../blog/index.html">Blog</a>
          </li>
          <li id="nav-faq">
            <a href="../../../faq.html">FAQ</a>
          </li>
        </ul>
        <form class="navbar-search pull-right" method="get" action="http://www.google.com/search">
          <input type="hidden" name="sitesearch" value="/Users/acabunoc/Projects/sc-site/_site" />
          <input name="q" type="text" class="search-query" placeholder="Search" />
        </form>
      </div>
    </div>
  </div>
</div>

    </header>
    <section class="content">
      <div class="container">
        <div class="row-fluid">
          <div class="span10 offset1">
            <h1 class="title">Handling Variant Configuration Files</h1>
            <!-- start content -->
            <p>One of our learners came to us with a problem last week. The program she uses depends on some complex configuration files, which she'd like to store in version control. However, a couple of parameters change depending on the machine the program is running on. She doesn't want to check <em>those</em> changes into version control over and over again; what should she do?</p>
<p>To make this more concrete, imagine that her configuration file is a Makefile containing instructions to rebuild a set of files. Initially, it looks like this:</p>
<pre>summary.dat : left.dat right.dat
        summarize left.dat right.dat &gt; summary.dat</pre>
<p>That works fine on one machine, but on another, the program <code>summarize</code> has been installed as <code>sum7</code>. She could do this:</p>
<pre>SUMMARIZE=summarize # on Linux
# SUMMARIZE=sum7 # on Mac OS X

summary.dat : left.dat right.dat
        ${SUMMARIZE} left.dat right.dat &gt; summary.dat</pre>
<p>but then she'd have to edit the file to uncomment one line, and recomment the other, whenever she switched from her Mac laptop to her desktop Linux machine and vice versa. Here's what she can do instead:</p>
<pre>ifeq ($(shell uname),Linux)
        SUMMARIZE=summarize
else
        SUMMARIZE=sum7
endif

summary.dat : left.dat right.dat
        ${SUMMARIZE} left.dat right.dat &gt; summary.dat</pre>
<p>The trick is that Makefiles (and most other grown-up configuration files) allow conditionals and functions, just like programs. The function <code>$(shell <em>whatever</em>)</code> runs a shell command; <code>ifeq</code> then checks if that command's output is the string <code>Linux</code>, and the Makefile's variable <code>SUMMARIZE</code> is set accordingly.</p>
<p>Another way to approach the problem is to put the machine-dependent parameters in separate files, and include one of those in the main file. For example, the Makefile could be written like this:</p>
<pre>include settings.mk

summary.dat : left.dat right.dat
        ${SUMMARIZE} left.dat right.dat &gt; summary.dat</pre>
<p>We would then put two files in version control&mdash;one for Linux:</p>
<pre># settings-linux.mk
SUMMARIZE=summarize</pre>
<p>and one for Mac OS X:</p>
<pre># settings-macosx.mk
SUMMARIZE-sum7</pre>
<p>Notice that neither of these is called <code>settings.mk</code>. The first time we check out on a machine, we manually copy either <code>settings-linux.mk</code> or <code>settings-macosx.mk</code> to create <code>settings.mk</code>. The <code>include</code> in the main Makefile then finds what it's looking for, and everything runs. If someone changes the settings for a particular platform, our next version control update will get the new platform-specific file, and we'll have to re-copy it to install it.</p>
<p>That manual copying step is why I'm not a fan of this second approach. There <em>are</em> ways to have the copying done automatically, but they all basically come down to including a conditional in the main Makefile, and if we're going to do that, we might as well use that for setting the parameter values anyway. However, some configuration file formats don't support conditionals, so the "include if available and fail if not" trick is still worth knowing.</p>

            <p><em>Originally posted 2012-06-26 by Greg Wilson in Content, Tutorial.</em></p>
            <!-- end content -->
            
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'software-carpentry';
    var disqus_developer = 1;
    var disqus_identifier = '';
    var disqus_title = 'Handling Variant Configuration Files';
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


          </div>
        </div>
      </div>
    </section>
    <footer class="content">
  <div class="container">
      <a class="label swc-blue-bg" href="https://twitter.com/swcarpentry">Twitter</a>
      <a class="label swc-blue-bg" href="http://software-carpentry.org/feed.xml">RSS</a>
      <a class="label swc-blue-bg" href="https://github.com/swcarpentry">GitHub</a>
      <a class="label swc-blue-bg" href="irc://freenode/swcarpentry">IRC</a>
      <a class="label swc-blue-bg" href="https://www.facebook.com/SoftwareCarpentry">Facebook</a>
      <a class="label swc-blue-bg" href="https://www.google.com/+Software-carpentryOrg">Google+</a>
      <a class="label swc-blue-bg" href="../../../license.html">License</a>
      <a class="bugreport label swc-blue-bg" href="mailto:info@software-carpentry.org?subject=bug%20in%20blog/2012/06/handling-variant-configuration-files.html">Bug Report</a>
  </div>
</footer>


    <!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="../../../js/jquery-1.9.1.min.js"></script>
<script src="../../../js/bootstrap/bootstrap.min.js"></script>

    <!-- Google Analytics -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-37305346-1']);
  _gaq.push(['_setDomainName', 'software-carpentry.org']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

  </body>
</html>
